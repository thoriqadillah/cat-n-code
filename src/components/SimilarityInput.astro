---
import Button from "./Button.astro";
---

<div class="flex flex-col md:flex-row">
  <textarea class="docs bg-dark rounded-md w-full p-3 mb-2 md:mr-2 h-36" placeholder="Write something"/>
  <textarea class="docs bg-dark rounded-md w-full p-3 mb-1 h-36" placeholder="Write something else"/>
</div>

<Button color="second" roundtype="md" classname="calculate mt-1">Calculate</Button>
<p id="result" class="text-second inline p-2 font-bold ml-auto"></p>

<script>
  import Preprocessing from '../services/preprocessing'
  import CosineSimilarity from '../services/cosine-similarity'
  
  const cossim = new CosineSimilarity()

  const inputs = document.querySelectorAll('.docs') as NodeListOf<HTMLInputElement>
  const btn = document.querySelector('.calculate') as HTMLElement
  const p = document.querySelector('#result') as HTMLElement
  
  btn.onclick = () => {  
    const documents: string[] = []
    inputs.forEach(el => documents.push(el.value))

    const vectors = Preprocessing.preprocess(documents)
    const similarity = cossim.getSimilarity(vectors[0], vectors[1])
    p.innerHTML = 'Similarity: ' + similarity.toString() + '%'
  }

</script>